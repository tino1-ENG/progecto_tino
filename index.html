<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>MarketPro | Marketplace Moderno</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== RESET ===== */
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Arial,sans-serif}
body{background:#f4f6f8}

/* ===== HEADER ===== */
header{
    background:#111827;color:white;
    padding:15px 20px;
    display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;position:relative
}
header h1{font-size:20px}
.menu-btn{display:block;font-size:22px;cursor:pointer;z-index:2}
nav{display:none;flex-direction:column;width:100%;position:absolute;top:60px;left:0;background:#111827;transition:0.3s}
nav.show{display:flex}
nav button{margin:3px 10px;padding:8px 10px;border:none;border-radius:6px;background:#2563eb;color:white;cursor:pointer}

/* CART BADGE */
#cartBtn{position:relative}
#cartBadge{
    position:absolute;
    top:-5px;right:-10px;
    background:red;color:white;
    border-radius:50%;
    padding:2px 6px;font-size:12px
}

/* HERO */
.hero{text-align:center;padding:40px 15px;background:linear-gradient(120deg,#2563eb,#1e40af);color:white;transition:0.3s}

/* CONTAINER */
.container{max-width:1200px;margin:auto;padding:15px}

/* MODALS */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);justify-content:center;align-items:center}
.modal-content{background:white;padding:20px;border-radius:10px;width:90%;max-width:350px}
.modal-content input,.modal-content button{width:100%;padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc}
.modal-content button{background:#2563eb;color:white;border:none;cursor:pointer;transition:0.3s}
.modal-content button:hover{background:#1e40af}

/* ADMIN */
.admin{display:none;background:white;padding:20px;border-radius:10px;margin-bottom:25px}
.admin input,.admin button{width:100%;padding:10px;margin:6px 0;border-radius:6px}

/* FILTERS */
.filters{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}
.filters input,.filters select{padding:8px;border-radius:6px;border:1px solid #ccc;width:100%}

/* PRODUCTS */
.products{display:grid;grid-template-columns:1fr;gap:15px}
.card{background:white;border-radius:12px;padding:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);transition:0.3s}
.card:hover{transform:scale(1.03);box-shadow:0 8px 20px rgba(0,0,0,.2)}
.card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
.card span{color:#2563eb;font-weight:bold}
.card button{width:100%;margin-top:5px;padding:7px;border:none;border-radius:6px;cursor:pointer;transition:0.3s}
.buy{background:#22c55e;color:white}
.edit{background:#f59e0b;color:white}
.delete{background:#ef4444;color:white}

/* CART / HISTORY */
.cart, .history{background:white;padding:15px;border-radius:10px;margin-top:20px;transition:0.3s}
.cart-item{display:flex;justify-content:space-between;margin:5px 0}

/* PAGINATION */
.pagination{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin:15px 0}
.pagination button{background:#2563eb;color:white;border:none;padding:6px 12px;border-radius:5px;cursor:pointer;transition:0.3s}
.pagination button:hover{background:#1e40af}

/* RESPONSIVE TABLETS/DESKTOP */
@media(min-width:600px){.products{grid-template-columns:repeat(2,1fr)}}
@media(min-width:900px){.products{grid-template-columns:repeat(3,1fr)}}
</style>
</head>
<body>

<header>
<h1>MarketPro</h1>
<div class="menu-btn" onclick="toggleMenu()">â˜°</div>
<nav id="menu">
<button onclick="openLogin()">Login</button>
<button onclick="openRegister()">Cadastrar</button>
<button onclick="logout()">Sair</button>
<button id="cartBtn" onclick="scrollToCart()">Carrinho ðŸ›’ <span id="cartBadge">0</span></button>
</nav>
</header>

<section class="hero">
<h2>Marketplace Moderno</h2>
<p>Login â€¢ Carrinho â€¢ HistÃ³rico â€¢ Admin â€¢ Mobile Friendly â€¢ AnimaÃ§Ãµes</p>
</section>

<div class="container">

<!-- ADMIN -->
<div class="admin" id="adminPanel">
<h3>Painel Admin</h3>
<input id="pNome" placeholder="Nome do produto">
<input id="pPreco" placeholder="PreÃ§o">
<input id="pCategoria" placeholder="Categoria">
<input type="file" id="pImagem">
<button onclick="salvarProduto()">Salvar Produto</button>
</div>

<!-- FILTERS -->
<div class="filters">
<input id="busca" placeholder="Buscar produto" oninput="aplicarFiltros()">
<select id="filtroCategoria" onchange="aplicarFiltros()">
<option value="">Todas categorias</option>
</select>
</div>

<!-- PRODUCTS -->
<div class="products" id="listaProdutos"></div>

<!-- PAGINATION -->
<div class="pagination" id="paginacao"></div>

<!-- CART -->
<div class="cart" id="cartSection">
<h3>Carrinho</h3>
<div id="itensCarrinho"></div>
<p><strong>Total: R$ <span id="total">0</span></strong></p>
<button class="buy" onclick="checkout()">Finalizar Compra</button>
</div>

<!-- HISTORY -->
<div class="history" id="historySection">
<h3>HistÃ³rico de Compras</h3>
<div id="historico"></div>
</div>

</div>

<!-- LOGIN MODAL -->
<div class="modal" id="loginModal">
<div class="modal-content">
<h3>Login</h3>
<input id="loginEmail" placeholder="Email">
<input id="loginSenha" type="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
</div>
</div>

<!-- REGISTER MODAL -->
<div class="modal" id="registerModal">
<div class="modal-content">
<h3>Cadastro</h3>
<input id="regNome" placeholder="Nome">
<input id="regEmail" placeholder="Email">
<input id="regSenha" type="password" placeholder="Senha">
<button onclick="register()">Cadastrar</button>
</div>
</div>

<script>
/* ===== DATA ===== */
let produtos=JSON.parse(localStorage.produtos||"[]");
let usuarios=JSON.parse(localStorage.usuarios||"[]");
let compras=JSON.parse(localStorage.compras||"[]");
let usuarioLogado=JSON.parse(localStorage.usuarioLogado||"null");
let carrinho=[];
let editIndex=null;
let paginaAtual=1;
const porPagina=6;
let produtosFiltrados=[...produtos];

/* ===== MENU ===== */
function toggleMenu(){menu.classList.toggle("show")}

/* ===== SCROLL TO CART ===== */
function scrollToCart(){cartSection.scrollIntoView({behavior:"smooth"})}

/* ===== MODALS ===== */
function openLogin(){loginModal.style.display="flex"}
function openRegister(){registerModal.style.display="flex"}
window.onclick=e=>{
if(e.target.classList.contains("modal")) e.target.style.display="none";
}

/* ===== AUTH ===== */
function register(){
if(!regNome.value||!regEmail.value||!regSenha.value)return alert("Preencha todos os campos");
if(usuarios.some(u=>u.email===regEmail.value)) return alert("Email jÃ¡ cadastrado");
usuarios.push({nome:regNome.value,email:regEmail.value,senha:regSenha.value,tipo:"cliente"});
localStorage.usuarios=JSON.stringify(usuarios);
alert("Cadastro realizado!");
registerModal.style.display="none";
}
function login(){
const u=usuarios.find(u=>u.email===loginEmail.value && u.senha===loginSenha.value);
if(!u)return alert("Email ou senha invÃ¡lidos");
usuarioLogado=u;
localStorage.usuarioLogado=JSON.stringify(u);
loginModal.style.display="none";
adminPanel.style.display=u.tipo==="admin"?"block":"none";
renderProdutos();
renderHistorico();
renderCarrinho();
updateCartBadge();
}
function logout(){
usuarioLogado=null;
localStorage.removeItem("usuarioLogado");
adminPanel.style.display="none";
renderProdutos();
renderCarrinho();
updateCartBadge();
}

/* ===== IMAGE ===== */
function lerImagem(file,cb){
const r=new FileReader();
r.onload=e=>cb(e.target.result);
r.readAsDataURL(file);
}

/* ===== CRUD ===== */
function salvarProduto(){
if(!pNome.value||!pPreco.value||!pCategoria.value)return alert("Preencha todos os campos");
const salvar=img=>{
const p={nome:pNome.value,preco:pPreco.value,categoria:pCategoria.value,imagem:img};
editIndex==null?produtos.push(p):produtos[editIndex]=p;
localStorage.produtos=JSON.stringify(produtos);
editIndex=null;
atualizarCategorias();aplicarFiltros();
}
if(pImagem.files[0]) lerImagem(pImagem.files[0],salvar);
else salvar(produtos[editIndex]?.imagem||"");
}
function editProduto(i){editIndex=i;pNome.value=produtos[i].nome;pPreco.value=produtos[i].preco;pCategoria.value=produtos[i].categoria}
function deleteProduto(i){produtos.splice(i,1);localStorage.produtos=JSON.stringify(produtos);aplicarFiltros()}

/* ===== FILTER ===== */
function atualizarCategorias(){
filtroCategoria.innerHTML='<option value="">Todas categorias</option>';
[...new Set(produtos.map(p=>p.categoria))].forEach(c=>filtroCategoria.innerHTML+=`<option>${c}</option>`);
}
function aplicarFiltros(){
produtosFiltrados=produtos.filter(p=>
p.nome.toLowerCase().includes(busca.value.toLowerCase()) &&
(filtroCategoria.value===""||p.categoria===filtroCategoria.value)
);
paginaAtual=1;
renderProdutos();
}

/* ===== RENDER ===== */
function renderProdutos(){
listaProdutos.innerHTML="";
produtosFiltrados.slice((paginaAtual-1)*porPagina,paginaAtual*porPagina).forEach((p,i)=>{
listaProdutos.innerHTML+=`
<div class="card">
<img src="${p.imagem||'https://via.placeholder.com/300'}">
<h4>${p.nome}</h4>
<p>${p.categoria}</p>
<span>R$ ${p.preco}</span>
<button class="buy" onclick="addCarrinho(${i+(paginaAtual-1)*porPagina})">Comprar</button>
${usuarioLogado?.tipo==="admin"?`<button class="edit" onclick="editProduto(${i+(paginaAtual-1)*porPagina})">Editar</button>
<button class="delete" onclick="deleteProduto(${i+(paginaAtual-1)*porPagina})">Excluir</button>`:""}
</div>`;
});
renderPaginacao();
}
function renderPaginacao(){
paginacao.innerHTML="";
for(let i=1;i<=Math.ceil(produtosFiltrados.length/porPagina);i++)
paginacao.innerHTML+=`<button onclick="paginaAtual=${i};renderProdutos()">${i}</button>`;
}

/* ===== CART ===== */
function addCarrinho(i){
carrinho.push(produtos[i]);
renderCarrinho();
updateCartBadge();
}
function renderCarrinho(){
itensCarrinho.innerHTML="";
let total=0;
carrinho.forEach(p=>{total+=Number(p.preco);itensCarrinho.innerHTML+=`<div class="cart-item"><span>${p.nome}</span><span>R$ ${p.preco}</span></div>`});
document.getElementById("total").innerText=total.toFixed(2);
}
function updateCartBadge(){
cartBadge.innerText=carrinho.length;
}
function checkout(){
if(!usuarioLogado)return alert("FaÃ§a login para comprar");
if(carrinho.length===0)return alert("Carrinho vazio");
compras.push({email:usuarioLogado.email,data:new Date().toLocaleString(),itens:[...carrinho],total:document.getElementById("total").innerText});
localStorage.compras=JSON.stringify(compras);
carrinho=[];renderCarrinho();updateCartBadge();renderHistorico();
alert("Compra finalizada!");
}

/* ===== HISTORY ===== */
function renderHistorico(){
historico.innerHTML="";
compras.filter(c=>c.email===usuarioLogado?.email).forEach(c=>{
historico.innerHTML+=`<p><strong>${c.data}</strong> - R$ ${c.total}</p>`;
});
}

/* ===== INIT ===== */
atualizarCategorias();aplicarFiltros();
if(usuarioLogado){adminPanel.style.display=usuarioLogado.tipo==="admin"?"block":"none";renderHistorico();renderCarrinho();updateCartBadge();}
</script>
</body>
</html>
